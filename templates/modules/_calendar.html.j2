{% import "modules/macros.j2" as mod %}
{% import "modules/event.macros.j2" as calendar %}


{% set events = config.past if module.time == 'past' else config.future %}
{% set has_filters = true if (module.time == 'past' or module.has_filters) else false %}


{% if events %}
  {% call mod.section(
    slug=['calendar', module.time]|join('-'),
    has_filters=has_filters
  ) %}
    <h2 class="section-title">
      {{ module.title or ['the', module.time]|join(' ') }}
    </h2>

    {% if has_filters %}
      {{ mod.filters(
        list=events|map(attribute='type')|unique_chain,
        uuid=module.time,
        lookup=config.event_tags[0]
      ) }}
    {% endif %}

    {% for event in events %}
      {{ calendar.show(event) }}
    {% endfor %}

  {% endcall %}
{% endif %}
